<h1><a id="gpx-plugin-for-leaflet" class="heading_anchor" href="#gpx-plugin-for-leaflet" aria-hidden="true">#</a>GPX plugin for Leaflet</h1>
<p><a href="https://cdnjs.com/libraries/leaflet-gpx"><img src="https://img.shields.io/cdnjs/v/leaflet-gpx.svg" alt="CDNJS"></a></p>
<p><a href="http://www.leafletjs.com">Leaflet</a> is a Javascript library for displaying
interactive maps. This plugin, based on the work of <a href="http://github.com/shramov">Pavel
Shramov</a> and his
<a href="http://github.com/shramov/leaflet-plugins">leaflet-plugins</a>, allows for
displaying and analyzing GPX tracks and their waypoints so they can be
displayed on a Leaflet map as a new layer.</p>
<p>As it parses the GPX data, <code>leaflet-gpx</code> records information about the
GPX track, including total time, moving time, total distance, elevation
stats and heart-rate, and makes it accessible through an exhaustive set
of accessor methods.</p>
<p>GPX parsing will automatically handle pauses in the track with a default
tolerance interval of 15 seconds between points. You can configure this
interval by setting <code>max_point_interval</code>, in milliseconds, in the options
passed to the <code>GPX</code> constructor.</p>
<p>I’ve put together a complete example as a
<a href="http://mpetazzoni.github.io/leaflet-gpx/">demo</a>.</p>
<h2><a id="license" class="heading_anchor" href="#license" aria-hidden="true">#</a>License</h2>
<p><code>leaflet-gpx</code> is under the <em>BSD 2-clause license</em>. Please refer to the
attached LICENSE file and/or to the copyright header in gpx.js for more
information.</p>
<h2><a id="usage" class="heading_anchor" href="#usage" aria-hidden="true">#</a>Usage</h2>
<p>Usage is very simple:</p>
<ul>
<li>Include the Leaflet stylesheet and script, and the leaflet-gpx script,
in your HTML page;</li>
<li>Create your Leaflet map, with your choice of base layer(s);</li>
<li>Create the <code>L.GPX</code> layer to display your GPX track.</li>
</ul>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js<span class="token punctuation">"</span></span> <span class="token attr-name">defer</span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/2.1.0/gpx.min.js<span class="token punctuation">"</span></span> <span class="token attr-name">defer</span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- ... --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- ... --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token string">'map'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">tileLayer</span><span class="token punctuation">(</span><span class="token string">'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">attribution</span><span class="token operator">:</span> <span class="token string">'Map data &amp;copy; &lt;a href="http://www.osm.org">OpenStreetMap&lt;/a>'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// URL to your GPX file or the GPX itself as a XML string.</span>
      <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'https://mpetazzoni.github.io/leaflet-gpx/demo.gpx'</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">async</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">polyline_options</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'red'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> gpx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
     </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>
<h3><a id="importing-from-a-non-module-context" class="heading_anchor" href="#importing-from-a-non-module-context" aria-hidden="true">#</a>Importing from a non-module context</h3>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token string">'map'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">tileLayer</span><span class="token punctuation">(</span><span class="token string">'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">attribution</span><span class="token operator">:</span> <span class="token string">'Map data &amp;copy; &lt;a href="http://www.osm.org">OpenStreetMap&lt;/a>'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'gpx.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span><span class="token string">'https://...'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2><a id="functions" class="heading_anchor" href="#functions" aria-hidden="true">#</a>Functions</h2>
<p>If you want to display additional information about the GPX track, you can do
so in the ‘loaded’ event handler, calling one of the following methods on the
<code>GPX</code> object <code>e.target</code>:</p>
<ul>
<li><code>get_name()</code>: returns the name of the GPX track</li>
<li><code>get_distance()</code>: returns the total track distance, in meters</li>
<li><code>get_start_time()</code>: returns a Javascript <code>Date</code> object representing the
starting time</li>
<li><code>get_end_time()</code>: returns a Javascript <code>Date</code> object representing when the
last point was recorded</li>
<li><code>get_moving_time()</code>: returns the moving time, in milliseconds</li>
<li><code>get_total_time()</code>: returns the total track time, in milliseconds</li>
<li><code>get_moving_pace()</code>: returns the average moving pace in milliseconds per km</li>
<li><code>get_moving_speed()</code>: returns the average moving speed in km per hour</li>
<li><code>get_total_speed()</code>: returns the average total speed in km per hour</li>
<li><code>get_elevation_min()</code>: returns the lowest elevation, in meters</li>
<li><code>get_elevation_max()</code>: returns the highest elevation, in meters</li>
<li><code>get_elevation_gain()</code>: returns the cumulative elevation gain, in meters</li>
<li><code>get_elevation_loss()</code>: returns the cumulative elevation loss, in meters</li>
<li><code>get_speed_max()</code>: returns the maximum speed in km per hour</li>
<li><code>get_average_hr()</code>: returns the average heart rate (if available)</li>
<li><code>get_average_cadence()</code>: returns the average cadence (if available)</li>
<li><code>get_average_temp()</code>: returns the average of the temperature (if available)</li>
</ul>
<p>If you’re not a fan of the metric system, you also have the following methods
at your disposal:</p>
<ul>
<li><code>get_distance_imp()</code>: returns the total track distance in miles</li>
<li><code>get_moving_pace_imp()</code>: returns the average moving pace in milliseconds per
hour</li>
<li><code>get_moving_speed_imp()</code>: returns the average moving speed in miles per hour</li>
<li><code>get_total_speed_imp()</code>: returns the average total speed in miles per hour</li>
<li><code>get_elevation_min_imp()</code>: returns the lowest elevation, in feet</li>
<li><code>get_elevation_max_imp()</code>: returns the highest elevation, in feet</li>
<li><code>get_elevation_gain_imp()</code>: returns the cumulative elevation gain, in feet</li>
<li><code>get_elevation_loss_imp()</code>: returns the cumulative elevation loss, in feet</li>
<li><code>get_speed_max_imp()</code>: returns the maximum speed in miles per hour</li>
</ul>
<p>The reason why these methods return milliseconds is that you have at your
disposal nice helper methods to format a duration in milliseconds into a cool
string:</p>
<ul>
<li><code>get_duration_string(duration, hidems)</code> format to a string like <code>3:07'48&quot;</code>
or <code>59'32.431</code>, where <code>duration</code> is in
milliseconds and <code>hidems</code> is an optional boolean you can use to request never
to display millisecond precision.</li>
<li><code>get_duration_string_iso(duration, hidems)</code> formats to an ISO like
representation like <code>3:07:48</code> or <code>59:32.431</code>, where <code>duration</code> is in
milliseconds and <code>hidems</code> is an optional boolean you can use to request never
to display millisecond precision.</li>
</ul>
<p>You can also get full elevation, heartrate, cadence and temperature data with:</p>
<ul>
<li><code>get_elevation_data()</code> and <code>get_elevation_data_imp()</code></li>
<li><code>get_speed_data</code> and <code>get_speed_data_imp()</code></li>
<li><code>get_heartrate_data()</code> and <code>get_heartrate_data_imp()</code></li>
<li><code>get_cadence_data()</code> and <code>get_cadence_data_imp()</code></li>
<li><code>get_temp_data()</code> and <code>get_temp_data_imp()</code></li>
</ul>
<p>These methods all return an array of points <code>[distance, value, tooltip]</code> where
the distance is either in kilometers or in miles and the elevation in meters or
feet, depending on whether you use the <code>_imp</code> variant or not. Heart rate,
obviously, doesn’t change.</p>
<h2><a id="reloading" class="heading_anchor" href="#reloading" aria-hidden="true">#</a>Reloading</h2>
<p>You can make <code>leaflet-gpx</code> reload the source GPX file by calling the
<code>reload()</code> method. For example, to trigger a reload every 5 seconds, you
can do:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> gpx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gpx<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2><a id="about-marker-icons" class="heading_anchor" href="#about-marker-icons" aria-hidden="true">#</a>About marker icons</h2>
<h3><a id="configuring-markers" class="heading_anchor" href="#configuring-markers" aria-hidden="true">#</a>Configuring markers</h3>
<p>By default, <code>leaflet-gpx</code> uses Leaflet’s default icon image for all
markers. You can override this behavior by providing a Leaflet <code>Icon</code>
object, or the path or URL to an image to use as the marker, for any of
the markers supported by this plugin as part of the <code>markers</code> parameter:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">async</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">markers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">startIcon</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
    <span class="token literal-property property">endIcon</span><span class="token operator">:</span> <span class="token operator">...</span>
    <span class="token literal-property property">wptIcons</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">wptTypeIcons</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">pointMatchers</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token operator">...</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<ul>
<li><code>startIcon</code> is used for the marker at the beginning of the GPX track;</li>
<li><code>endIcon</code> is used for the marker at the end of the GPX track;</li>
<li><code>wptIcons</code> and <code>wptTypeIcons</code> are mappings of waypoint symbols and
types to the icon you want to use for each;</li>
<li><code>pointMatchers</code> is an array of custom point matchers and their
respective icon (see below);</li>
</ul>
<p>You can also override any of those to <code>null</code> to disable the
corresponding marker altogether.</p>
<p>Here is how you would override the URL of the provided icons for start
and end markers, but none of the other types of markers:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">async</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">markers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">startIcon</span><span class="token operator">:</span> <span class="token string">'images/pin-icon-start.png'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">endIcon</span><span class="token operator">:</span> <span class="token string">'images/pin-icon-end.png'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>It’s usually preferrable and more flexible to provide a Leaflet <code>Icon</code>
instance directly, for example from
<a href="https://github.com/lennardv2/Leaflet.awesome-markers">leaflet-awesome-markers</a>. See
<a href="https://leafletjs.com/examples/custom-icons/">https://leafletjs.com/examples/custom-icons/</a> for more information.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">async</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">markers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">wptIcons</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'Coffee shop'</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>AwesomeMarkers<span class="token punctuation">.</span>icon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'coffee'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'fa'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">markerColor</span><span class="token operator">:</span> <span class="token string">'blue'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">iconColor</span><span class="token operator">:</span> <span class="token string">'white'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3><a id="marker-options" class="heading_anchor" href="#marker-options" aria-hidden="true">#</a>Marker options</h3>
<p>You can fine tune marker options using any of the parameters expected by
<a href="https://leafletjs.com/reference.html#icon">Leaflet’s base L.Icon class</a>
using the <code>marker_options</code> parameters:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">async</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">marker_options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">iconSize</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">iconAnchor</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3><a id="sensible-defaults" class="heading_anchor" href="#sensible-defaults" aria-hidden="true">#</a>Sensible defaults</h3>
<p>Note that you do not need to override all the marker definitions, or
marker options, when providing the <code>markers</code> and <code>marker_options</code>
parameters to the GPX constructor as this plugin will use sensible
defaults for all of those settings.</p>
<h2><a id="about-waypoints" class="heading_anchor" href="#about-waypoints" aria-hidden="true">#</a>About waypoints</h2>
<p>By default, this plugin will parse all Waypoints from a GPX file. This
can be controlled via the value <code>waypoint</code> in <code>gpx_options</code>, e.g.
<code>parseElements: ['track', 'route', 'waypoint']</code>.</p>
<p>The icon used in the marker representing each track waypoint is
determined based on the waypoint’s properties, in this order:</p>
<ul>
<li>If the waypoint has a <code>sym</code> attribute, the <code>markers.wptIcons[sym]</code>
icon is used;</li>
<li>If the waypoint has a <code>type</code> attribute, the <code>markers.wptTypeIcons[type]</code>
icon is used;</li>
<li>Point matchers are evaluated in order, if one matches the waypoint’s
<code>name</code> attribute, its icon is used (see <em>Named markers</em> below);</li>
<li>If none of the above rules match, the default <code>''</code> (empty string) icon
entry in <code>wptIcons</code> is used.</li>
</ul>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">async</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">markers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">wptIcons</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">''</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>Icon<span class="token punctuation">.</span>Default</span><span class="token punctuation">,</span>
      <span class="token string-property property">'Geocache Found'</span><span class="token operator">:</span> <span class="token string">'img/gpx/geocache.png'</span><span class="token punctuation">,</span>
      <span class="token string-property property">'Park'</span><span class="token operator">:</span> <span class="token string">'img/gpx/tree.png'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2><a id="named-points" class="heading_anchor" href="#named-points" aria-hidden="true">#</a>Named points</h2>
<p>GPX points can be named, for example to denote certain POIs (points of
interest). You can setup rules to match point names to create labeled
markers for those points by providing a <code>pointMatchers</code> array in the
<code>markers</code> constructor parameter.</p>
<p>Each element in this array must define a <code>regex</code> to match the point’s
name and an <code>icon</code> definition (a <code>L.Icon</code> or subclass object, or the URL
to an icon image).</p>
<p>Each named point in the GPX track is evaluated against those rules and
a marker is created with the point’s name as label from the first
matching rule. This also applies to named waypoints, but keep in mind
that waypoint icons rules take precedence over point matchers.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">async</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">marker_options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">pointMatchers</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">regex</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Coffee</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>AwesomeMarkers<span class="token punctuation">.</span>icon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'coffee'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">markerColor</span><span class="token operator">:</span> <span class="token string">'blue'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">iconColor</span><span class="token operator">:</span> <span class="token string">'white'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">regex</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">Home</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>AwesomeMarkers<span class="token punctuation">.</span>icon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">markerColor</span><span class="token operator">:</span> <span class="token string">'green'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">iconColor</span><span class="token operator">:</span> <span class="token string">'white'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">.</span><span class="token function">fitToBounds</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2><a id="events" class="heading_anchor" href="#events" aria-hidden="true">#</a>Events</h2>
<p>Events are fired on the <code>L.GPX</code> object as the GPX data is being parsed
and the map layers generated. You can listen for those events by
attaching the corresponding event listener on the <code>L.GPX</code> object:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token literal-property property">async</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// options</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'addpoint'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Added '</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>point_type <span class="token operator">+</span> <span class="token string">' point: '</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> gpx <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
  map<span class="token punctuation">.</span><span class="token function">fitToBounds</span><span class="token punctuation">(</span>gpx<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error loading file: '</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Note that for your event listeners to be correctly triggered, you need
to pass <code>async: true</code> to the <code>L.GPX</code> constructor; otherwise the parsing
of the GPX happens synchronously in the constructor before you your
event listeners get registered!</p>
<p><code>addpoint</code> events are fired for every marker added to the map, in
particular for the start and end points, all the waypoints, and all the
named points that matched <code>pointMatchers</code> rules. Each <code>addpoint</code> event
contains the following properties:</p>
<ul>
<li><code>point</code>: the marker object itself, from which you can get or modify
the latitude and longitude of the point and any other attribute of the
marker.</li>
<li><code>point_type</code>: one of <code>start</code>, <code>end</code>, <code>waypoint</code> or <code>label</code>, allowing
you to identify what type of point the marker is for.</li>
<li><code>element</code>: the track point element the marker was created for.</li>
</ul>
<p>One use case for those events is for example to attach additional
content or behavior to the markers that were generated (popups, etc).</p>
<p><code>error</code> events are fired when no layers of the type(s) specified in
<code>options.gpx_options.parseElements</code> can be parsed out of the given
file. For instance, <code>error</code> would be fired if a file with no waypoints
was attempted to be loaded with <code>parseElements</code> set to <code>['waypoint']</code>.
Each <code>error</code> event contains the following property:</p>
<ul>
<li><code>err</code>: a message with details about the error that occurred.</li>
</ul>
<h2><a id="line-styling" class="heading_anchor" href="#line-styling" aria-hidden="true">#</a>Line styling</h2>
<p><code>leaflet-gpx</code> understands the <a href="http://www.topografix.com/GPX/gpx_style/0/2">GPX
Style</a> extension, and will
extract styling information defined on routes and track segments to use
for drawing the corresponding polyline.</p>
<pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trkseg</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>extensions</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.topografix.com/GPX/gpx_style/0/2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>color</span><span class="token punctuation">></span></span>FF0000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>color</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>opacity</span><span class="token punctuation">></span></span>0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>opacity</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>weight</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>weight</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linecap</span><span class="token punctuation">></span></span>square<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linecap</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linejoin</span><span class="token punctuation">></span></span>square<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linejoin</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dasharray</span><span class="token punctuation">></span></span>0,10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dasharray</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dashoffset</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dashoffset</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>line</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>extensions</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trkpt</span> <span class="token attr-name">lat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>...<span class="token punctuation">"</span></span> <span class="token attr-name">lon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>...<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trkpt</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trkseg</span><span class="token punctuation">></span></span></code></pre>
<p>You can override the style of the lines by passing a <code>polyline_options</code>
array into the <code>options</code> argument of the <code>L.GPX</code> constructor, each
element of the array defines the style for the corresponding route
and/or track in the file (in the same order).</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">polyline_options</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'green'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.75</span><span class="token punctuation">,</span>
    <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lineCap</span><span class="token operator">:</span> <span class="token string">'round'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'blue'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.75</span><span class="token punctuation">,</span>
    <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> gpx <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
  map<span class="token punctuation">.</span><span class="token function">fitToBounds</span><span class="token punctuation">(</span>gpx<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>If you have many routes or tracks in your GPX file and you want them to
share the same styling, you can pass <code>polyline_options</code> as a single
object rather than an array (this is also how <code>leaflet-gpx</code> worked
before the introduction of the array):</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">polyline_options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'green'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.75</span><span class="token punctuation">,</span>
    <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lineCap</span><span class="token operator">:</span> <span class="token string">'round'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> gpx <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
  map<span class="token punctuation">.</span><span class="token function">fitToBounds</span><span class="token punctuation">(</span>gpx<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>For more information on the available polyline styling options, refer to
the <a href="https://leafletjs.com/reference.html#polyline">Leaflet documentation on
Polyline</a>. By
default, if no styling is available, the line will be drawn in <em>blue</em>.</p>
<h2><a id="gpx-parsing-options" class="heading_anchor" href="#gpx-parsing-options" aria-hidden="true">#</a>GPX parsing options</h2>
<h3><a id="selecting-which-elements-define-the-track" class="heading_anchor" href="#selecting-which-elements-define-the-track" aria-hidden="true">#</a>Selecting which elements define the track</h3>
<p>Some GPX tracks contain the actual route/track twice, both the <code>&lt;trk&gt;</code>
and <code>&lt;rte&gt;</code> elements are used. You can tell <code>leaflet-gpx</code> which tag to
use or to use both (which is the default setting for backwards
compatibility). The <code>parseElements</code> field of <code>gpx_options</code> controls this
behavior. It should be an array that contains <code>'route'</code> and/or <code>'track'</code>
and/or <code>'waypoint'</code>.</p>
<h3><a id="multiple-track-segments-within-each-track" class="heading_anchor" href="#multiple-track-segments-within-each-track" aria-hidden="true">#</a>Multiple track segments within each track</h3>
<p>GPX file may contain multiple tracks represented by <code>&lt;trk&gt;</code> elements,
each track possibly composed of multiple segments with <code>&lt;trkseg&gt;</code>
elements. Although this plugin will always represent each GPX route and
each GPX track as distinct entities with their own start and end
markers, track segments will by default be joined into a single line.</p>
<p>You can disable this behavior by setting the <code>joinTrackSegments</code> flag to
<code>false</code> in the <code>gpx_options</code>:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>GPX</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">gpx_options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">joinTrackSegments</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2><a id="caveats" class="heading_anchor" href="#caveats" aria-hidden="true">#</a>Caveats</h2>
<ul>
<li>Distance calculation is relatively accurate, but elevation change
calculation is not topographically adjusted, so the total elevation
gain/loss/change might appear inaccurate in some situations.</li>
<li>Currently doesn’t seem to work in IE8/9. See #9 and #11 for
discussion.</li>
</ul>
